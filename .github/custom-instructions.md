write all the code for better memory management for perfomance and efficiency.